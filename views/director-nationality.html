{% extends "layout.html" %}

{% set title = "What is the director's nationality?" %}

{% block pageTitle %}
  {% include "includes/page-title.html" %}
{% endblock %}

{% block backLink %}
  {% include "includes/back-link.html" %}
{% endblock %}

{% block content %}

{% if errors %}
  {% set dropdownOneError =  errors.typeahead_input_0 %}
  {% set dropdownTwoError =  errors.typeahead_input_1 %}
  {% set dropdownThreeError =  errors.typeahead_input_2 %}
{% endif %}
{% set typeaheadHint = "Start typing a nationality, then choose from the list|Dual citizenship (also known as dual nationality) is allowed in some countries. This means you can be a citizen of your own country and another country.|Multiple citizenship (also known as multiple nationality) is allowed in some countries. This means you can be a citizen of your own country and two other countries." %}
{% set typeaheadTitle = "<h1 class='govuk-label-wrapper'><label class='govuk-label govuk-label--l' for='typeahead_input_0'>What is the director's nationality?</label></h1>|<label class='govuk-label' for='typeahead_input_1'>Second nationality (if relevant)</label>|<label class='govuk-label' for='typeahead_input_2'>Third nationality (if relevant)</label>" | safe %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds-from-desktop">

      {% include "includes/list/errors.html" %}
      
      <form action="" method="post">
            
        {% set dropdownDefaultText = "Choose nationality" %}
        <span class="govuk-caption-l">{{directorName}}</span>
        <div id="typeahead-form-group-0" class="govuk-form-group">
        <div id="my-autocomplete-container-0" class="autocomplete-wrapper govuk-!-width-two-thirds"></div>
        {% set dropdownNumber = "0" %}
        {% set dropdownTitle = typeaheadTitle.split("|")[dropdownNumber] %}
        {% set dropdownValue = typeahead_value.split("|")[dropdownNumber] %}
        {% set errorMessage = dropdownOneError %}
        {% include "includes/inputs/fields/typeahead-noscript-input.html" %}
        </div>
        <p id="nationality-2-link" class="govuk-body" style="display: none;">
          <a data-event-id="nationality-2-link" href="#" id="second-nationality-link" class="govuk-link govuk-link--no-visited-state">Add a second nationality</a>
        </p>

        <div id="typeahead-form-group-1" class="govuk-form-group">
        <div id="my-autocomplete-container-1" class="autocomplete-wrapper govuk-!-width-two-thirds"></div>
        {% set dropdownNumber = "1" %}
        {% set dropdownTitle = typeaheadTitle.split("|")[dropdownNumber] %}
        {% set dropdownHint = typeaheadHint.split("|")[dropdownNumber] %}
        {% set dropdownValue = typeahead_value.split("|")[dropdownNumber] %}
        {% set errorMessage = dropdownTwoError %}
        {% include "includes/inputs/fields/typeahead-noscript-input.html" %}
        </div>
        <p id= "nationality-3-link" class="govuk-body" style="display: none;">
          <a data-event-id="nationality-3-link" href="#" id="third-nationality-link" class="govuk-link govuk-link--no-visited-state">Add a third nationality</a>
        </p>

        <div id="typeahead-form-group-2" class="govuk-form-group">
        <div id="my-autocomplete-container-2" class="autocomplete-wrapper govuk-!-width-two-thirds"></div>
        {% set dropdownNumber = "2" %}
        {% set dropdownTitle = typeaheadTitle.split("|")[dropdownNumber] %}
        {% set dropdownHint = typeaheadHint.split("|")[dropdownNumber] %}
        {% set dropdownValue = typeahead_value.split("|")[dropdownNumber] %}
        {% set errorMessage = dropdownThreeError %}
        {% include "includes/inputs/fields/typeahead-noscript-input.html" %}
        </div>

        {{ govukInsetText({
          html: "<h2 class='govuk-heading-m'>What information we'll show on the public online register</h2>
          <p>We will show the director's nationality on the public Companies House register.</p>"
        }) }}

        {{ govukButton({
          attributes: {
            "data-event-id": "continue-button"
          },
          text: "Continue"
        }) }}

        <!-- Hidden radio buttons to record whether links are clicked -->
        {{ govukRadios({
          id: "nationality_2_radio",
          name: "nationality_2_radio",
          attributes: {
            "style": "display: none;"
          },
          items: [
            {
              id: "nationality_2_radio_yes",
              value: true,
              text: "Yes"
            }
          ]
        }) }}

        {{ govukRadios({
          id: "nationality_3_radio",
          name: "nationality_3_radio",
          attributes: {
            "style": "display: none;"
          },
          items: [
            {
              id: "nationality_3_radio_yes",
              value: true,
              text: "Yes"
            }
          ]
        }) }}

      </form>
    </div>
    {% include "includes/inputs/fields/typeahead-input.html" %}
  </div>
  <script type="text/javascript">
    //show and hide nationality 
    $(document).ready(function () {
      // If link has already been clicked, set up the page as it was before
      if ("{{nationality2_hidden}}" === "true") {
        $('#nationality-2-link').hide();
        radiobtn = document.getElementById("nationality_2_radio_yes");
        radiobtn.checked = true;
        $('#nationality-3-link').show();
      }
      else {
        $('#nationality-2-link').show();
        $('#typeahead-form-group-1').hide();
        $('#nationality-2-link').click(function () {
          $('#typeahead-form-group-1').show();
          $('#nationality-3-link').show();
          $('#nationality-2-link').hide();
          radiobtn = document.getElementById("nationality_2_radio_yes");
          radiobtn.checked = true;
          return false;
        });
      }

      if ("{{nationality3_hidden}}" === "true") {
        $('#nationality-3-link').hide();
        radiobtn = document.getElementById("nationality_3_radio_yes");
        radiobtn.checked = true;
      }
      else {
        $('#typeahead-form-group-2').hide();
        $('#nationality-3-link').click(function () {
          $('#typeahead-form-group-2').show();
          $('#nationality-3-link').hide();
          radiobtn = document.getElementById("nationality_3_radio_yes");
          radiobtn.checked = true;
          return false;
        });
      }
    })
  </script>
{% endblock %}
